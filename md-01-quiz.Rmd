---
title: "Module 1: Introduction to Quarto - Quiz"
output: 
  learnr::tutorial:
    progressive: true
    allow_skip: true
    theme: "sandstone"
runtime: shiny_prerendered
description: "Test your knowledge of Quarto basics, YAML headers, code chunks, and creating reproducible documents"
---

```{r setup, include=FALSE}
library(learnr)
library(tidyverse)
library(gapminder)
library(gt)
library(gradethis)

# Set up gradethis for exercise checking
gradethis::gradethis_setup()

# Load gapminder data for exercises
data(gapminder)

# Set exercise options
tutorial_options(
  exercise.eval = FALSE,
  exercise.timelimit = 60,
  exercise.cap = "Submit Code"
)

# Create sample data for exercises
africa_2007 <- gapminder %>%
  filter(continent == "Africa", year == 2007)
```

## Welcome to the Module 1 Quiz!

This interactive tutorial will test your understanding of Quarto basics covered in Module 1. The quiz is divided into three sections:

1. **Quarto Fundamentals** - YAML headers and document structure
2. **Code Chunks and Options** - Managing code execution and output
3. **Data Analysis Integration** - Combining R code with Quarto documents

Each section contains a mix of multiple choice questions and coding exercises. Don't worry if you make mistakes - you can try again!

### Tips for Success:
- Read each question carefully
- For coding exercises, pay attention to the exact syntax required
- Use the hints when you're stuck
- Remember that Quarto uses YAML syntax which is sensitive to indentation

Let's begin!

## Section 1: Quarto Fundamentals

### Question 1.1: YAML Header Basics

```{r yaml-basics, echo=FALSE}
question("Which of the following is the correct way to specify HTML output in a Quarto YAML header?",
  answer("format: html", correct = TRUE),
  answer("output: html"),
  answer("type: html"),
  answer("render: html"),
  incorrect = "Remember that Quarto uses 'format:' to specify output types, not 'output:' like R Markdown.",
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

### Question 1.2: Multiple Output Formats

```{r multiple-formats, echo=FALSE}
question("How do you specify multiple output formats in Quarto?",
  answer("List each format with proper indentation under 'format:'", correct = TRUE),
  answer("Separate formats with commas: format: html, pdf"),
  answer("Use multiple format: lines"),
  answer("Create separate YAML headers for each format"),
  incorrect = "In YAML, multiple formats are specified as a nested list under 'format:' with proper indentation.",
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

### Question 1.3: YAML Configuration Exercise

Write a YAML header that includes:
- Title: "My Analysis Report"
- HTML output format
- Table of contents enabled

```{r yaml-exercise, exercise=TRUE, exercise.lines=6}
# Write your YAML header below (including the --- delimiters)

```

```{r yaml-exercise-hint-1}
# Remember that YAML headers start and end with ---
# The basic structure is:
# ---
# key: value
# ---
```

```{r yaml-exercise-hint-2}
# For table of contents in HTML, you need to nest toc under html:
# ---
# title: "Your Title"
# format:
#   html:
#     toc: true
# ---
```

```{r yaml-exercise-check}
grade_this({
  # Check if student included the YAML delimiters and correct structure
  if (grepl("---.*title:.*[\"']My Analysis Report[\"'].*format:.*html:.*toc:.*true.*---", 
            gsub("\\s+", " ", .user_code), ignore.case = TRUE)) {
    pass("Excellent! You've created a proper YAML header with all required elements.")
  } else if (grepl("title:.*[\"']My Analysis Report[\"']", .user_code) && 
             grepl("format:.*html", .user_code) && 
             grepl("toc:.*true", .user_code)) {
    pass("Good work! Your YAML header contains all the required elements. Make sure to use proper indentation in practice.")
  } else {
    fail("Your YAML header is missing some elements. Make sure to include: title, format: html with toc: true")
  }
})
```

### Question 1.4: Document Structure

```{r document-structure, echo=FALSE}
question("In Quarto, how do you create a level 2 heading?",
  answer("## Heading Text", correct = TRUE),
  answer("** Heading Text **"),
  answer("<h2>Heading Text</h2>"),
  answer("= Heading Text ="),
  incorrect = "Quarto uses standard Markdown syntax for headings. Level 2 headings use two hash symbols (##).",
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

### Question 1.5: Visual Editor

```{r visual-editor, echo=FALSE}
question("What YAML option enables the visual editor mode in RStudio for Quarto documents?",
  answer("editor: visual", correct = TRUE),
  answer("mode: visual"),
  answer("visual: true"),
  answer("editor_mode: visual"),
  incorrect = "The correct option is 'editor: visual' at the top level of your YAML header.",
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

## Section 2: Code Chunks and Options

### Question 2.1: Code Chunk Syntax

```{r chunk-syntax, echo=FALSE}
question("What is the correct syntax to start an R code chunk in Quarto?",
  answer("```{r}", correct = TRUE),
  answer("```r"),
  answer("{r}"),
  answer("```[r]"),
  incorrect = "R code chunks in Quarto start with three backticks followed by {r}",
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

### Question 2.2: Chunk Options

```{r chunk-options, echo=FALSE}
question("Which chunk option suppresses warning messages in Quarto?",
  answer("#| warning: false", correct = TRUE),
  answer("#| message: false"),
  answer("#| suppress: warnings"),
  answer("#| hide-warnings: true"),
  incorrect = "Use '#| warning: false' to suppress warning messages. Note that '#| message: false' suppresses messages, not warnings.",
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

### Question 2.3: Code Chunk Exercise

Create a code chunk that:
- Has the label "analysis"
- Suppresses messages
- Loads the ggplot2 package

```{r chunk-exercise, exercise=TRUE, exercise.lines=6}
# Create your code chunk below (including the backticks)

```

```{r chunk-exercise-hint-1}
# Start with three backticks and {r}
# Add chunk options using #| syntax
# Don't forget to close with three backticks
```

```{r chunk-exercise-hint-2}
# The structure should be:
# ```{r}
# #| label: your-label
# #| message: false
# library(package_name)
# ```
```

```{r chunk-exercise-check}
grade_this({
  if (grepl("`{3}\\{r\\}.*#\\|.*label:.*analysis.*#\\|.*message:.*false.*library\\(ggplot2\\).*`{3}", 
            gsub("\\s+", " ", .user_code), ignore.case = TRUE)) {
    pass("Perfect! You've created a properly formatted code chunk with all required elements.")
  } else if (grepl("label:.*analysis", .user_code) && 
             grepl("message:.*false", .user_code) && 
             grepl("library\\(ggplot2\\)", .user_code)) {
    pass("Good work! You have all the required elements. In practice, make sure to use proper code chunk delimiters.")
  } else {
    fail("Check that you have: label: analysis, message: false, and library(ggplot2)")
  }
})
```

### Question 2.4: Figure Options

```{r figure-options, echo=FALSE}
question("Which TWO chunk options would you use to create a figure that is 8 inches wide with a 16:9 aspect ratio?",
  answer("#| fig-width: 8", correct = TRUE),
  answer("#| fig-asp: 0.5625", correct = TRUE),
  answer("#| fig-height: 4.5"),
  answer("#| fig-ratio: 16:9"),
  answer("#| width: 8"),
  incorrect = "Use fig-width for width and fig-asp for aspect ratio. The aspect ratio for 16:9 is 9/16 = 0.5625",
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

### Question 2.5: Code Folding

```{r code-folding, echo=FALSE}
question("How do you enable code folding in the HTML output of a Quarto document?",
  answer("Add 'code-fold: true' under format: html: in the YAML", correct = TRUE),
  answer("Use #| code-fold: true in each chunk"),
  answer("Add 'folding: true' to the YAML header"),
  answer("Set 'show-code: collapsible' in the YAML"),
  incorrect = "Code folding is enabled globally in the YAML header under format: html: with code-fold: true",
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

## Section 3: Data Analysis Integration

### Question 3.1: Data Exploration

```{r data-exploration, echo=FALSE}
question("Which function would you use to view the first 6 rows of the gapminder dataset?",
  answer("head(gapminder)", correct = TRUE),
  answer("view(gapminder)"),
  answer("first(gapminder, 6)"),
  answer("show(gapminder, 6)"),
  incorrect = "The head() function displays the first few rows of a dataset (6 by default).",
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

### Question 3.2: Data Filtering Exercise

Using the gapminder dataset, write code to filter for European countries in the year 1952.

```{r filter-exercise, exercise=TRUE, exercise.setup = "setup"}
# Filter gapminder for European countries in 1952

```

```{r filter-exercise-hint-1}
# Use the filter() function from dplyr
# You need to filter for two conditions:
# - continent == "Europe"
# - year == 1952
```

```{r filter-exercise-hint-2}
# The syntax is:
# gapminder %>%
#   filter(condition1, condition2)
```

```{r filter-exercise-solution}
gapminder %>%
  filter(continent == "Europe", year == 1952)
```

```{r filter-exercise-check}
grade_this_code()
```

### Question 3.3: Summarizing Data

Complete the code to calculate the mean life expectancy by continent for the year 2007:

```{r summarize-exercise, exercise=TRUE, exercise.setup = "setup"}
gapminder %>%
  filter(___) %>%
  group_by(___) %>%
  summarise(___)
```

```{r summarize-exercise-hint-1}
# Fill in the blanks:
# 1. Filter for year == 2007
# 2. Group by continent
# 3. Summarise with mean_life_exp = mean(lifeExp)
```

```{r summarize-exercise-solution}
gapminder %>%
  filter(year == 2007) %>%
  group_by(continent) %>%
  summarise(mean_life_exp = mean(lifeExp))
```

```{r summarize-exercise-check}
grade_this_code()
```

### Question 3.4: Creating Visualizations

```{r visualization-mcq, echo=FALSE}
question("Which ggplot2 geometry would you use to create a boxplot?",
  answer("geom_boxplot()", correct = TRUE),
  answer("geom_box()"),
  answer("boxplot()"),
  answer("plot_box()"),
  incorrect = "In ggplot2, geometries start with 'geom_' followed by the plot type.",
  allow_retry = TRUE,
  random_answer_order = TRUE
)
```

### Question 3.5: Complete Visualization Exercise

Create a boxplot of life expectancy by continent using the africa_2007 data (already filtered for African countries in 2007). Add jittered points on top of the boxplot.

```{r viz-exercise, exercise=TRUE, exercise.setup = "setup"}
# Create a boxplot with jittered points
# Use the africa_2007 dataset

```

```{r viz-exercise-hint-1}
# Start with ggplot() and specify the data and aesthetics
# Add geom_boxplot() first
# Then add geom_jitter() for the points
```

```{r viz-exercise-hint-2}
# The structure should be:
# ggplot(data = africa_2007, aes(x = continent, y = lifeExp)) +
#   geom_boxplot() +
#   geom_jitter()
```

```{r viz-exercise-solution}
ggplot(data = africa_2007, aes(x = continent, y = lifeExp)) +
  geom_boxplot() +
  geom_jitter()
```

```{r viz-exercise-check}
grade_this({
  # Check for required components
  if (grepl("ggplot.*africa_2007", .user_code) &&
      grepl("geom_boxplot", .user_code) &&
      grepl("geom_jitter", .user_code)) {
    pass("Excellent! You've created a boxplot with jittered points showing the distribution of life expectancy.")
  } else if (grepl("ggplot", .user_code) && 
             (grepl("geom_boxplot", .user_code) || grepl("geom_jitter", .user_code))) {
    fail("You're on the right track! Make sure to include both geom_boxplot() and geom_jitter().")
  } else {
    fail("Use ggplot() with africa_2007 data, then add both geom_boxplot() and geom_jitter().")
  }
})
```

## Quiz Complete!

Congratulations on completing the Module 1 Quiz! 

### Your Progress:
- You've tested your knowledge of Quarto YAML headers
- You've practiced creating and configuring code chunks
- You've integrated R data analysis with Quarto documents

### Next Steps:
1. Review any questions you found challenging
2. Practice creating your own Quarto documents
3. Experiment with different YAML options and chunk settings
4. Move on to Module 2 to learn more advanced features!

### Additional Resources:
- [Quarto Documentation](https://quarto.org/)
- [R for Data Science](https://r4ds.had.co.nz/)
- [ggplot2 Reference](https://ggplot2.tidyverse.org/)

```{r}
# Generate a completion certificate (optional)
if (exists("user_name")) {
  cat(paste0("Certificate of Completion\n",
             "This certifies that ", user_name, "\n",
             "has completed the Module 1 Quarto Quiz\n",
             "Date: ", Sys.Date()))
}
```